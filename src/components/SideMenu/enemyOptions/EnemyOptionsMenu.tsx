import React from "react";
import type {
  EnemyOptionType,
  EntityOptionClickHandler,
} from "@/types/entities";
import {
  EntityOptionsMenu,
  type EntityOptionDefinition,
} from "../entityOptions/EntityOptionsMenu";
import { composeMapIconFromSvg } from "../entityOptions/iconComposer";

const ENEMY_BACKGROUND_RED = "#EF5350";
const ENEMY_ICON_DARK = "#1E1E1E";

const getEnemyIconElement = (type: EnemyOptionType) => {
  switch (type) {
      case "EnemyA":
        return (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clipPath="url(#enemyA)">
              <path d="M9.63226 13.1942L10.5227 12.3037L8.36331 10.1443C7.87151 9.65247 7.87151 8.85511 8.36331 8.36331C8.85511 7.87151 9.65247 7.87151 10.1443 8.36331L12.3037 10.5227L13.1942 9.63226L12.768 9.2061C12.5221 8.9602 12.5221 8.56151 12.768 8.31561C13.0139 8.06971 13.4126 8.06971 13.6585 8.31561L14.0847 8.74178L20.693 2.13347C20.9777 1.84874 21.4393 1.84874 21.7241 2.13347L22.0799 2.48933L15.8275 10.4846L18.8678 14.4154L19.7393 15.2868L15.2868 19.7393L14.4154 18.8678L10.4846 15.8275L2.48933 22.0799L2.13347 21.7241C1.84874 21.4393 1.84874 20.9777 2.13347 20.693L8.74178 14.0847L8.31561 13.6585C8.06971 13.4126 8.06971 13.0139 8.31561 12.768C8.56151 12.5221 8.9602 12.5221 9.2061 12.768L9.63226 13.1942ZM11.6192 15.2925L15.1775 18.8507L18.7863 15.2419L15.228 11.6837L14.3258 12.5859L14.758 13.018C15.2562 13.5163 15.2562 14.3241 14.758 14.8224C14.2597 15.3207 13.4518 15.3207 12.9536 14.8224L12.5214 14.3903L11.6192 15.2925Z" fill="white" />
            </g>
            <defs>
              <clipPath id="enemyA">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        );
      case "EnemyB":
        return (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clipPath="url(#enemyB)">
              <path d="M4.62333 4.25253C5.12448 3.72977 5.92742 3.70095 6.46186 4.18646L7.59629 5.21726L11.4305 9.41024C11.5105 9.27966 11.6073 9.15681 11.7236 9.04808L18.9951 2.25331C19.4907 1.7904 20.2465 1.812 20.7169 2.30286C21.1955 2.80226 21.2077 3.60799 20.7445 4.12283L14.0616 11.5465C13.9457 11.6753 13.8146 11.7803 13.6753 11.864L17.153 15.6654L17.1542 15.6679C17.3352 15.4713 17.5808 15.3305 17.8788 15.2923L21.2053 14.8665C21.3965 14.842 21.5782 14.9609 21.6391 15.1516C21.6964 15.331 21.6319 15.5286 21.482 15.6349L18.7095 17.6004C18.6657 17.6315 18.6198 17.658 18.5735 17.6824L18.8028 18.0073C19.0131 18.3059 18.9824 18.7203 18.7312 18.9824C18.48 19.2442 18.0834 19.2758 17.7973 19.0564L17.4708 18.8062C17.442 18.8733 17.4077 18.9388 17.367 19.0014L15.4833 21.8943C15.3815 22.0508 15.1921 22.1181 15.0202 22.0583C14.8374 21.9947 14.7235 21.8051 14.747 21.6056L15.155 18.1345C15.1943 17.8011 15.3457 17.5299 15.556 17.338L15.5531 17.3349L11.8971 13.695C11.8131 13.8604 11.7036 14.0158 11.5653 14.1514L4.45097 21.1248C3.95757 21.6081 3.18542 21.5954 2.70682 21.096C2.23642 20.6051 2.21572 19.8165 2.65934 19.2993L9.171 11.7117C9.28868 11.5745 9.42238 11.4615 9.56614 11.3728L5.54025 7.36269L4.55356 6.16426C4.09415 5.60602 4.12468 4.77285 4.62333 4.25253Z" fill="white" />
            </g>
            <defs>
              <clipPath id="enemyB">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        );
      case "EnemyC":
        return (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.8543 6.50253C21.9701 6.44826 22.0521 6.34081 22.0741 6.21495C22.0961 6.08908 22.0553 5.96039 21.9648 5.87002L20.568 4.47421C20.4732 4.37954 20.3368 4.33976 20.2061 4.36849L9.02999 6.81995L4.58665 2.37996C4.27316 2.06646 3.8417 1.90008 3.39894 1.92181C2.95594 1.94355 2.54291 2.15119 2.26138 2.49367C1.75373 3.1446 1.81874 4.07329 2.41228 4.64699L6.80844 9.03983L4.35513 20.2075C4.32637 20.3381 4.36631 20.4746 4.46093 20.5691L5.85779 21.9649C5.94823 22.0553 6.07702 22.0961 6.20298 22.0741C6.32894 22.0521 6.43646 21.9702 6.4909 21.8546L10.6963 12.9248L14.4541 16.6797C14.5364 16.7622 14.578 16.8769 14.5674 16.9928L14.3231 19.6791C14.3125 19.795 14.3539 19.9098 14.4364 19.9922L15.3217 20.8768C15.4095 20.9646 15.5337 21.0056 15.6564 20.9876C15.7793 20.9697 15.8863 20.8946 15.9453 20.7853L17.5832 17.7459C17.6195 17.6784 17.6751 17.6229 17.7427 17.5866L20.7844 15.95C20.8937 15.891 20.9688 15.7841 20.9868 15.6613C21.0048 15.5386 20.9638 15.4146 20.8759 15.3268L19.9908 14.4423C19.9083 14.3599 19.7934 14.3185 19.6774 14.3291L16.9891 14.5732C16.8731 14.5837 16.7584 14.5422 16.6758 14.46L12.9179 10.7049L21.8543 6.50253Z" fill="white" />
          </svg>
        );
      case "EnemyD":
        return (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clipPath="url(#enemyD)">
              <path d="M9.63226 13.1942L10.5227 12.3037L8.36331 10.1443C7.87151 9.65247 7.87151 8.85511 8.36331 8.36331C8.85511 7.87151 9.65247 7.87151 10.1443 8.36331L12.3037 10.5227L13.1942 9.63226L12.768 9.2061C12.5221 8.9602 12.5221 8.56151 12.768 8.31561C13.0139 8.06971 13.4126 8.06971 13.6585 8.31561L14.0847 8.74178L20.693 2.13347C20.9777 1.84874 21.4393 1.84874 21.7241 2.13347L22.0799 2.48933L15.8275 10.4846L18.8678 14.4154L19.7393 15.2868L15.2868 19.7393L14.4154 18.8678L10.4846 15.8275L2.48933 22.0799L2.13347 21.7241C1.84874 21.4393 1.84874 20.9777 2.13347 20.693L8.74178 14.0847L8.31561 13.6585C8.06971 13.4126 8.06971 13.0139 8.31561 12.768C8.56151 12.5221 8.9602 12.5221 9.2061 12.768L9.63226 13.1942ZM11.6192 15.2925L15.1775 18.8507L18.7863 15.2419L15.228 11.6837L14.3258 12.5859L14.758 13.018C15.2562 13.5163 15.2562 14.3241 14.758 14.8224C14.2597 15.3207 13.4518 15.3207 12.9536 14.8224L12.5214 14.3903L11.6192 15.2925Z" fill="white" />
            </g>
            <defs>
              <clipPath id="enemyD">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        );
      case "EnemyE":
        return (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.876 10.9569L16.9441 13.6325L17.4191 14.1074L21.7095 14.2383L22.0799 15.9067L19.8544 17.5337L18.6607 17.6757L18.3877 17.9488L19.133 18.6941L18.6941 19.133L17.9488 18.3877L17.6843 18.6522L17.5331 19.8552L15.9067 22.0799L14.2382 21.7095L14.1074 17.4191L13.6325 16.9441L10.9568 21.8758L8.94392 19.8629L8.95844 19.7155C8.9602 19.6974 9.13649 17.8846 9.18952 15.9766C9.24904 13.8364 9.12223 12.7599 8.98739 12.2199C8.84799 12.5516 8.71079 12.9156 8.64741 13.0909L8.48173 13.5489L7.43446 12.5016L7.31401 10.9665C7.26043 10.283 7.0406 9.61259 6.67843 9.02762C6.07808 8.05806 5.37894 7.16071 4.60037 6.36044C4.54916 6.30779 4.36838 6.12502 4.12733 5.88125C3.86919 5.62017 3.54208 5.28939 3.23044 4.9732C2.52017 4.25248 2.06943 3.30373 1.96114 2.30172L1.91992 1.91992L2.30184 1.96118C3.3039 2.06943 4.25262 2.5202 4.97331 3.23043C5.29002 3.54259 5.62133 3.87022 5.88262 4.12856C6.12574 4.36904 6.30799 4.5493 6.36055 4.60043C7.16087 5.37896 8.05827 6.07813 9.02784 6.67839C9.61281 7.04056 10.2832 7.26042 10.9666 7.31405L12.5018 7.4345L13.5491 8.48175L13.0911 8.6474C12.9158 8.71078 12.5519 8.84798 12.2201 8.98741C12.76 9.12229 13.8366 9.24906 15.9768 9.18954C17.8849 9.13655 19.6976 8.96023 19.7157 8.95847L19.8631 8.94399L21.876 10.9569Z" fill="white" />
          </svg>
        );
    }
};

const enemyOptions: EnemyOptionType[] = ["EnemyA", "EnemyB", "EnemyC", "EnemyD", "EnemyE"];

const ENEMY_OPTION_DEFINITIONS: EntityOptionDefinition<"Enemy">[] = enemyOptions.map((type) => ({
  type,
  name: type,
  color: ENEMY_ICON_DARK,
  renderIcon: () => getEnemyIconElement(type),
  createMapIconPath: (iconHost: HTMLSpanElement) => {
    const iconSvg = iconHost.querySelector("svg");
    if (!iconSvg) {
      return "";
    }

    return composeMapIconFromSvg(iconSvg, ENEMY_BACKGROUND_RED, ENEMY_ICON_DARK);
  },
}));

export function EnemyOptionsMenu({
  id,
  className,
  onOptionClick,
}: {
  id?: string;
  className?: string;
  onOptionClick?: EntityOptionClickHandler<"Enemy">;
}) {
  return (
    <EntityOptionsMenu<"Enemy">
      id={id}
      className={className}
      options={ENEMY_OPTION_DEFINITIONS}
      onOptionClick={onOptionClick}
    />
  );
}